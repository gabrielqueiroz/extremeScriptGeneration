<!DOCTYPE html>
<html lang="pt-br">
<head>
	<!-- 		configure snmp sysName \"X\"
				configure snmp sysContact \"X\"
				
				configure ports X display-string \"X\"
				configure ports X description-string \"X\"

				enable sharing X grouping X algorithm address-based L2 lacp

				configure vlan X delete ports X 
				create vlan \"X\"
				configure vlan X tag X

				configure vlan X add ports X X  
				configure vlan Default ipaddress X X

				configure iproute add default X -->

	<title>TDec Extreme Script</title>
	<link rel="stylesheet" href="css/bootstrap.min.css"/>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script src="js/jquery-1.11.3.js"></script>	
	<script>
		// Global variables
		var vlanCount = 0;		
		var portCount = 0;
		var switchPort = 1;
		var output = "";

		// Function for default switch ports or custom port
		function addPort(portNumber){
			if(portNumber == 0){
				var div = document.createElement('div');
				div.setAttribute("id", "customPort");

			    div.innerHTML = '<div class="form-group">\
									<div class="col-sm-2 col-md-2">\
										<input class="form-control" id="customport'+portCount+'" placeholder="Port">\
									</div>\
									<div class="col-sm-5 col-md-5">\
										<input class="form-control" id="customdispstring'+portCount+'" placeholder="Display String">\
									</div>\
									<div class="col-sm-5 col-md-5">\
										<input class="form-control" id="customdescstring'+portCount+'" placeholder="Description String">\
									</div>\
								</div>';

				document.getElementById('divPort').appendChild(div);

				portCount ++;
			} else {
				switchPort = portNumber;

				while(document.getElementById('switchPort') !== null)
					document.getElementById('switchPort').remove();

				for(var i=1; i<=portNumber; i++){
				var div = document.createElement('div');
				div.setAttribute("id", "switchPort");

			    div.innerHTML = '<div class="form-group">\
									<label class="control-label col-sm-2 col-md-2" id="port'+i+'">Port'+i+'</label>\
									<div class="col-sm-5 col-md-5">\
										<input class="form-control" id="dispstring'+i+'" placeholder="Display String">\
									</div>\
									<div class="col-sm-5 col-md-5">\
										<input class="form-control" id="descstring'+i+'" placeholder="Description String">\
									</div>\
								</div>';

				document.getElementById('divPort').appendChild(div);
				}
			}			
		}

		// Function for remove the last VLAN
		function remPort(){
			while(document.getElementById('customPort') !== null)
				document.getElementById('customPort').remove();

			while(document.getElementById('switchPort') !== null)
				document.getElementById('switchPort').remove();		

			portCount = 0;
			switchPort = 1;	
		}
		
		// Function for add new VLAN
		function addVLAN(){			
			var div = document.createElement('div');
			div.setAttribute("id", "divVLAN"+vlanCount);

			if(vlanCount>0)
				div.innerHTML += '<hr>';
			else if(vlanCount<1)
				div.innerHTML += '<input id="vlanDefault" type="checkbox" value="configure vlan default delete ports all" checked> Deletar todas as VLANS para VLAN Default</input>\
					<hr>';

		    div.innerHTML += '<div class="form-group">\
								<label class="control-label col-sm-1 col-md-1">VLAN:</label>\
								<div class="col-sm-5 col-md-5">\
									<input class="form-control" id="vlan'+vlanCount+'" placeholder="VLAN">\
								</div>\
								<label class="control-label col-sm-1 col-md-1">Tag:</label>\
								<div class="col-sm-5 col-md-5">\
									<input class="form-control" id="tag'+vlanCount+'" placeholder="Tags">\
								</div>\
							</div>\
							<div class="form-group">\
								<label class="control-label col-sm-1 col-md-1">Tag:</label>\
								<div class="col-sm-5 col-md-5">\
									<input class="form-control" id="tagged'+vlanCount+'" placeholder="Port(s) Tagged">\
								</div>\
								<label class="control-label col-sm-1 col-md-1">Untag:</label>\
								<div class="col-sm-5 col-md-5">\
									<input class="form-control" id="untagged'+vlanCount+'" placeholder="Port(s) Untagged">\
								</div>\
							</div>\
							<div class="form-group">\
								<label class="control-label col-sm-1 col-md-1">IP:</label>\
								<div class="col-sm-5 col-md-5">\
									<input class="form-control" id="vlanip'+vlanCount+'" placeholder="IP Address">\
								</div>\
								<label class="control-label col-sm-1 col-md-1">Mask:</label>\
								<div class="col-sm-5 col-md-5">\
									<input class="form-control" id="vlanmask'+vlanCount+'" placeholder="Mask Address" value="255.255.255.0">\
								</div>\
							</div>';

			document.getElementById('divVLAN').appendChild(div);		

			vlanCount++;
		}

		// Function for remove the last VLAN
		function remVLAN(){
			if(document.getElementById('divVLAN'+(vlanCount-1)) !== null){
				document.getElementById('divVLAN'+(vlanCount-1)).remove();
				vlanCount--;
			}			
		}

		// Generate the script based on what you filled or not.
		function generateScript(){		
			output = "";

			// SNMP Configuration
			// System Name
			var sysName = document.getElementById("sysName").value;
			if (sysName.length>1)				
				output += "configure snmp sysName \""+sysName+"\"\n";					

			// System Location
			var sysLocation = document.getElementById("sysLocation").value;
			if(sysLocation.length>1)				
				output += "configure snmp sysLocation \""+sysLocation+"\"\n";

			// System Contact
			var sysContact = document.getElementById("sysContact").value;
			if(sysContact.length>1)
				output += "configure snmp sysContact \""+sysContact+"\"\n";

			// SNTP Configuration
			// System SNTP			
			var sysSNTP = document.getElementById("sysSNTP").value;
			if(sysSNTP.length>1 && document.getElementById('panelSNTP').style.display !== "none"){
				output += "configure sntp-client primary "+sysSNTP+" vr \"VR-Mgmt\"\n";
				output += "configure timezone name BRT -180 autodst name BRST 60 begins every third sunday october at 0:00 ends every third sunday february at 0:00"
			}
				
			
			// Ports Configuration
			// Custom Port Configuration					
			for (var i=0; i<=portCount; i++){				

				if (document.getElementById("customport"+i) !== null){					
					var port = document.getElementById("customport"+i);

					if (port.value.length > 0){
						var dispstring = document.getElementById("customdispstring"+i);

						if(dispstring.value.length > 1)
							output += "configure ports "+port.value+" display-string "+dispstring.value+"\n";				

						var descstring = document.getElementById("customdescstring"+i);				

						if(descstring.value.length > 1)
							output += "configure ports "+port.value+" description-string "+descstring.value+"\n";
					}
				}
			}

			// Default Switch Ports Configuration	
			for (var i=1;i<=switchPort;i++){			

				if(document.getElementById("dispstring"+i) !== null){
					var dispstring = document.getElementById("dispstring"+i);

					if(dispstring.value.length>1)
						output += "configure ports "+i+" display-string "+dispstring.value+"\n";
				}
					

				if(document.getElementById("descstring"+i) !== null){
					var descstring = document.getElementById("descstring"+i);

					if(descstring.value.length>1)
						output += "configure ports "+i+" description-string "+descstring.value+"\n";
				}									
			}
			
			// VLAN Configuration				
			if(document.getElementById("vlanDefault") !== null && document.getElementById("vlanDefault").checked)
				output += "configure vlan default delete all\n";

			for (var i=0;i<=vlanCount;i++){

				if(document.getElementById("vlan"+i) !== null){
					vlan = document.getElementById("vlan"+i);

					if (vlan.value.length > 0){
						output += "create vlan \""+vlan.value+"\"\n";
						
						tag = document.getElementById("tag"+i);
						if (tag.value.length > 0)	
							output += "configure vlan "+vlan.value+" tag "+tag.value+"\n";					

						tagged = document.getElementById("tagged"+i);	
						if (tagged.value.length > 0)	
							output += "configure vlan "+vlan.value+" add ports "+tagged.value+" tagged\n";
															
						untagged = document.getElementById("untagged"+i);
						if (untagged.value.length > 0)
							output += "configure vlan "+vlan.value+" add ports "+untagged.value+" untagged\n";
													
						vlanip = document.getElementById("vlanip"+i);
						vlanmask = document.getElementById("vlanmask"+i);																	
						if (vlanip.value.length > 0 && vlanmask.value.length > 0)
							output += "configure vlan "+vlan.value+" ipaddress "+vlanip.value+" "+vlanmask.value+"\n";

					}
				}														
			}		
	
			document.getElementById("output").value = output;
		}	

		// Function for download in TXT file
		function downloadTXT(){
			var script = document.getElementById('output').value;	
			script = script.replace(/\n/g, "\r\n");
			var filename = document.getElementById('filename').value;
			var link = document.createElement('a');
			mimeType = 'text/plain';

			if(filename.length>1)
				link.setAttribute('download', filename+".txt");
			else
				link.setAttribute('download', "output.txt");

			link.setAttribute('href', 'data:' + mimeType  +  ';charset=utf-8,' + encodeURIComponent(script));
			link.click();
		}

		// Function for download in XML file
		function downloadXML(){
			var script = document.getElementById('output').value;
			script = script.replace(/\n/g, "\r\n");
			var filename = document.getElementById('filename').value;
			var link = document.createElement('a');
			mimeType = 'text/plain';

			if(filename.length>1)
				link.setAttribute('download', filename+".xml");
			else
				link.setAttribute('download', "output.xml");

			link.setAttribute('href', 'data:' + mimeType  +  ';charset=utf-8,' + encodeURIComponent(script));
			link.click();
		}

		function toggler(divId) {
		    $("#"+divId).toggle();
		}

		function refresh() {
			location.reload();
		}

	</script>
</head>
<body style="padding-top:70px;">
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span> 
				</button>
				<a class="navbar-brand" href="javascript:refresh();">TDec Network Group</a>
			</div>
			<div class="collapse navbar-collapse" id="myNavbar" data-toggle="collapse" data-target=".nav-collapse.in">
				<ul class="nav navbar-nav">													
					<li><a href="#panelSNMP" data-toggle="collapse" data-target=".navbar-collapse">SNMP</a></li>
					<li><a href="#panelSNTP" data-toggle="collapse" data-target=".navbar-collapse">SNTP</a></li>
					<li><a href="#panelVLAN" data-toggle="collapse" data-target=".navbar-collapse">VLAN</a></li>
					<li><a href="#panelPort" data-toggle="collapse" data-target=".navbar-collapse">Ports</a></li> 
					<li><a href="#panelScript" data-toggle="collapse" data-target=".navbar-collapse">Criar Script</a></li>
					<li><a href="#panelExport" data-toggle="collapse" data-target=".navbar-collapse">Exportar Script</a></li> 
				</ul>
			</div>
		</div>
	</nav>

	<div class="container-fluid">	

			<div class="col-xs-12 col-sm-6 col-md-6">	

				<form class="form-horizontal" role="form">		

					<div class="panel panel-default">
  					<div class="panel-heading">
  						SNMP  						
  						<div class="btn-group pull-right" style="margin-top:13px">
							<input type="button" value="Configurar SNTP" onclick="javascript:toggler('panelSNMP');" class="btn btn-default">
						</div>
  					</div>
				    <div class="panel-body" style="margin-top:13px">
				    	<div id="panelSNMP" style="display:none">
							<div class="form-group">
								<label class="control-label col-sm-4 col-md-2" for="sysName">SysName:</label>
								<div class="col-sm-8 col-md-10">
									<input class="form-control" id="sysName" placeholder="SNMP SysName">
								</div>
						    </div>

						    <div class="form-group">
								<label class="control-label col-sm-4 col-md-2" for="sysContact">SysLocation:</label>
								<div class="col-sm-8 col-md-10">
									<input class="form-control" id="sysLocation" placeholder="SNMP SysLocation">
								</div>
						    </div>

						    <div class="form-group">
								<label class="control-label col-sm-4 col-md-2" for="sysContact">SysContact:</label>
								<div class="col-sm-8 col-md-10">
									<input class="form-control" id="sysContact" placeholder="SNMP SysContact">
								</div>
							</div>
						</div>
				   	</div>
					</div>

					<div class="panel panel-default">
  					<div class="panel-heading">
  						SNTP
  						<div class="btn-group pull-right" style="margin-top:13px">
							<input type="button" value="Configurar SNTP" onclick="javascript:toggler('panelSNTP');" class="btn btn-default">
						</div>
  					</div>					
				    <div class="panel-body" style="margin-top:15px">
						<div class="form-group" id="panelSNTP" style="display:none">
							<label class="control-label col-sm-4 col-md-2" for="sysContact">SNTP:</label>
							<div class="col-sm-8 col-md-10">
								<input class="form-control" id="sysSNTP" placeholder="SNTP Client" value="10.0.2.130">
							</div>
						</div>	
					</div>
					</div>

					<div class="panel panel-default" id="panelVLAN" >
						<div class="panel-heading">
							VLAN
							<div class="btn-group pull-right" style="margin-top:13px">
								<a href="javascript:addVLAN();" class="btn btn-default col-xs-6 col-sm-6 col-md-6">
									<span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> VLAN
								</a>
								<a href="javascript:remVLAN();" class="btn btn-default col-xs-6 col-sm-6 col-md-6">
									<span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span> VLAN
								</a>
							</div>
						</div>
							<div class="panel-body" id="divVLAN" style="margin-top:15px"> 															
								
							</div>							
					</div>	

					<div class="panel panel-default" >
					
	  					<div class="panel-heading" >
	  						Port(s)
	  						<div class="btn-group pull-right" style="margin-top:13px">							    
								<a href="javascript:addPort('24');" class="btn btn-default col-xs-3 col-sm-3 col-md-3">24 ports</a>
								<a href="javascript:addPort('48');" class="btn btn-default col-xs-3 col-sm-3 col-md-3">48 ports</a>
								<a href="javascript:addPort('0');" class="btn btn-default col-xs-3 col-sm-3 col-md-3">? port</a>
								<a href="javascript:remPort();" class="btn btn-default col-xs-3 col-sm-3 col-md-3">
									<span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> ports
								</a>					
						    </div>
	  					</div>					
					    <div class="panel-body" id="divPort" style="margin-top:15px">
							
					    </div>
					</div>													

				</form>

			</div>

			<div class="col-xs-12 col-sm-6 col-md-6">
				<form class="form-horizontal" role="form">

					<div class="form-group" id="panelScript">        
				     	<div class="col-sm-12">				     		
							<input type="button" value="Criar Script" onclick="javascript:generateScript();" class="btn btn-primary btn-block">	
						</div>
					</div>

					<textarea id='output' class="form-control" rows="15" style="width:100% ; overflow:auto; resize:none" placeholder="Seu script sera criado aqui" ></textarea>
					<br>

					<div class="panel panel-default" id="panelExport">
	  					<div class="panel-heading">Exportar Script</div>					
					    <div class="panel-body">
						    <div class="form-group">
							    <label class="control-label col-sm-1 col-md-1" for="sysName">Nome:</label>
							    <div class="col-sm-11 col-md-11">
							    	<input class="form-control" id="filename" placeholder="Nome do arquivo">
							    </div>
						    </div>

						    <div class="btn-group btn-block">							    
							    	<a href="javascript:downloadTXT();" class="btn btn-default col-xs-6 col-sm-6 col-md-6"><span class="glyphicon glyphicon-save" aria-hidden="true"></span> .TXT</a>
							    	<a href="javascript:downloadXML();" class="btn btn-default col-xs-6 col-sm-6 col-md-6"><span class="glyphicon glyphicon-save" aria-hidden="true"></span> .XML</a>
						    </div>
						</div>
					</div>
				</form>				
			</div>			

	</div>				
</body>
</html>